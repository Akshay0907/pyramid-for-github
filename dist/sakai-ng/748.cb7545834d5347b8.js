"use strict";(self.webpackChunksakai=self.webpackChunksakai||[]).push([[748],{5748:(z,g,a)=>{a.r(g),a.d(g,{TestingModule:()=>G});var d=a(9808),p=a(2047),s=a(2382),O=a(4327);class c{}var e=a(1223),u=a(9783),L=a(7476),q=a(5742),M=a(4637),h=a(4534),m=a(845),v=a(5787),f=a(1424),T=a(4297),_=a(7773),Z=a(8952),A=a(5652),b=a(5315),F=a(4132),S=a(4036),C=a(7102),w=a(8850),U=a(6526),y=a(4119);const N=["paginator"];function I(o,r){1&o&&(e.TgZ(0,"tr")(1,"th",34)(2,"div",35),e._uU(3," Date "),e.qZA()(),e.TgZ(4,"th",34)(5,"div",35),e._uU(6," Employee Code "),e.qZA()(),e.TgZ(7,"th",34)(8,"div",35),e._uU(9," Staff Name "),e.qZA()(),e.TgZ(10,"th",36)(11,"div",37),e._uU(12," In "),e.qZA()(),e.TgZ(13,"th",38)(14,"div",35),e._uU(15," Out "),e.qZA()(),e.TgZ(16,"th",39)(17,"div",35),e._uU(18," Type "),e.qZA()(),e.TgZ(19,"th",39)(20,"div",35),e._uU(21," Reason For Leave "),e.qZA()(),e._UZ(22,"th",40),e.qZA(),e.TgZ(23,"tr")(24,"th",41),e._uU(25,"Time"),e.qZA(),e.TgZ(26,"th",41),e._uU(27,"Location"),e.qZA(),e.TgZ(28,"th",41),e._uU(29,"Image"),e.qZA(),e.TgZ(30,"th",41),e._uU(31,"Time"),e.qZA(),e.TgZ(32,"th",41),e._uU(33,"Location"),e.qZA(),e.TgZ(34,"th",41),e._uU(35,"Image"),e.qZA()())}const x=function(o,r){return{OnLeave:o,Present:r}};function D(o,r){if(1&o){const n=e.EpF();e.TgZ(0,"tr",44)(1,"td"),e._uU(2),e.ALo(3,"date"),e.qZA(),e.TgZ(4,"td"),e._uU(5),e.qZA(),e.TgZ(6,"td"),e._uU(7),e.qZA(),e.TgZ(8,"td"),e._uU(9),e.qZA(),e.TgZ(10,"td"),e._uU(11),e._UZ(12,"br"),e._uU(13),e.qZA(),e.TgZ(14,"td",45)(15,"span",46),e._uU(16,"Image"),e.qZA(),e._UZ(17,"p-image",47),e.qZA(),e.TgZ(18,"td"),e._uU(19),e.qZA(),e.TgZ(20,"td"),e._uU(21),e._UZ(22,"br"),e._uU(23),e.qZA(),e.TgZ(24,"td",45)(25,"span",46),e._uU(26,"Image"),e.qZA(),e._UZ(27,"p-image",48),e.qZA(),e.TgZ(28,"td")(29,"span"),e._uU(30),e.qZA()(),e.TgZ(31,"td",41),e._uU(32),e.qZA(),e.TgZ(33,"td")(34,"div",49)(35,"button",50),e.NdJ("click",function(){e.CHM(n);const i=e.oxw(2).$implicit,l=e.oxw();return e.KtG(l.editAttendence(i))}),e.qZA()()()()}if(2&o){const n=e.oxw().$implicit,t=e.oxw().$implicit;e.Q6J("ngClass",e.WLB(23,x,1==t.onLeave,0==t.onLeave)),e.xp6(2),e.Oqu(e.xi3(3,20,t.date,"dd-MM-yyyy")),e.xp6(3),e.Oqu(t.employeeCode),e.xp6(2),e.Oqu(t.staffName),e.xp6(2),e.Oqu(t.startTime),e.xp6(2),e.Oqu(t.clockInLatitude),e.xp6(2),e.Oqu(t.clockInLongitude),e.xp6(4),e.s9C("src",t.clockIn),e.Q6J("hidden",!t.clockIn)("preview",t.clockIn),e.xp6(2),e.Oqu(t.endTime),e.xp6(2),e.Oqu(t.clockOutLatitude),e.xp6(2),e.Oqu(t.clockOutLongitude),e.xp6(4),e.s9C("src",t.clockOut),e.Q6J("hidden",!t.clockOut)("preview",t.clockOut),e.xp6(2),e.Tol("customer-badge status-"+n.value),e.xp6(1),e.Oqu(t.type),e.xp6(2),e.Oqu(t.reasonForLeave)}}function E(o,r){if(1&o&&(e.ynx(0),e.YNc(1,D,36,26,"tr",43),e.BQk()),2&o){const n=r.$implicit,t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf",n.label===t.type)}}function J(o,r){if(1&o&&e.YNc(0,E,2,1,"ng-container",42),2&o){const n=e.oxw();e.Q6J("ngForOf",n.statuses)}}function P(o,r){1&o&&(e.TgZ(0,"div",57),e._uU(1,"Please enter Leave option "),e.qZA())}function R(o,r){if(1&o&&(e.TgZ(0,"form",51),e._UZ(1,"img",52),e.TgZ(2,"div",53)(3,"label",54),e._uU(4,"Leave"),e.qZA(),e._UZ(5,"p-selectButton",55),e.YNc(6,P,2,0,"div",56),e.qZA()()),2&o){const n=e.oxw();e.Q6J("formGroup",n.editAttendenceForm),e.xp6(1),e.MGl("src","assets/layout/images/","pyramidlogo",".jpg",e.LSH),e.xp6(4),e.Q6J("options",n.leave),e.xp6(1),e.Q6J("ngIf",!n.editAttendenceForm.controls.onLeave.valid&&n.submitted)}}function V(o,r){if(1&o){const n=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.hideDialogForEdit())}),e.qZA(),e.TgZ(1,"button",59),e.NdJ("click",function(){e.CHM(n);const i=e.oxw();return e.KtG(i.saveAttendenceForEdit(i.editAttendenceForm.value.id,i.editAttendenceForm.value))}),e.qZA()}}const k=function(){return["Date","employeeCode","Staff_Name","In","Out","status"]},Q=function(){return[10,20,30]},B=function(){return[10,20,30,50]},j=function(){return{width:"450px"}};let Y=(()=>{class o{constructor(n,t,i,l){this.messageService=n,this.attendenceService=t,this.branchService=i,this.fileService=l,this.first=0,this.submitted=!1,this.productDialog=!1,this.productDialogForEdit=!1,this.deleteProductDialog=!1,this.deleteProductsDialog=!1,this.attendenceObjectForCreate=new c,this.attendenceObjectForEdit=new c,this.attendenceObjectForDelete=new c,this.attendenceObjectForSelectedDelete="",this.selectedAttendence=[],this.ids=new Array,this.eventa={page:0,rows:10,searchString:"",sortBy:"date",sortOrder:"DESC",branch:[],role:"",conveyanceApplicable:"",dateFrom:"",dateTo:"",onLeave:""},this.branchList=[],this.filterDialog=!1}ngOnInit(){this.statuses=[{label:"ON-LEAVE",value:"unqualified"},{label:"PRESENT",value:"qualified"},{label:"COMP-OFF",value:"proposal"}],this.getAttendances(this.eventa),this.branchService.getBranchList2().subscribe(n=>{this.branchList=n,console.log(this.branchList),console.log("response",n)}),this.leave=[{label:"PRESENT",value:"PRESENT"},{label:"LEAVE",value:"ON-LEAVE"},{label:"COMP OFF",value:"COMP-OFF"}],this.editAttendenceForm=new s.cw({id:new s.NI(""),startTime:new s.NI("",[s.kI.required]),endTime:new s.NI("",[s.kI.required]),onLeave:new s.NI("",[s.kI.required]),reasonForLeave:new s.NI("",[s.kI.required]),employeeAttendance:new s.NI("",[s.kI.required]),dateCreated:new s.NI("",[s.kI.required]),lastUpdated:new s.NI("",[s.kI.required])})}clearAllFilters(){this.eventa.branch=[],this.eventa.dateFrom="",this.eventa.dateTo="",this.eventa.onLeave="",this.getAttendances(this.eventa),this.dateFromFilterVariable="",this.dateToFilterVariable="",this.branchFilterVariable="",this.leaveFilterVariable=""}forSearch(n){this.eventa.searchString=n.target.value,this.getAttendances(this.eventa)}branchFilter(n){this.eventa.page=0,console.log(n),0!=n.value.length?(this.eventa.branch=[],n.value.forEach(t=>{this.eventa.branch.push(t.name),console.log(this.eventa.branch),this.getAttendances(this.eventa)})):(this.eventa.branch=[],this.getAttendances(this.eventa))}dateToFilter(n){this.eventa.dateTo=(0,d.p6)(n,"yyyy-MM-dd","en-US"),console.log(this.eventa),console.log(n),this.getAttendances(this.eventa),console.log(this.eventa)}dateFromFilter(n){this.eventa.page=0,this.eventa.dateFrom=(0,d.p6)(n,"yyyy-MM-dd","en-US"),console.log(this.eventa),console.log(n),this.getAttendances(this.eventa)}leaveFilter(n){this.eventa.page=0,this.eventa.onLeave=n.value.value,this.getAttendances(this.eventa),this.first=0,n.first=0,console.log(n)}hideOrShowFilter(){this.filterDialog=!this.filterDialog,console.log(this.filterDialog)}hideDialog(){console.log("hideDialog"+this.addAttendenceForm.value.startTime),console.log("-------------\x3e",this.attendenceObjectForCreate),this.productDialog=!1,this.submitted=!1}editAttendence(n){this.editAttendenceForm.patchValue({id:n.id}),1==n.onLeave?(console.log("in true filed"),this.editAttendenceForm.patchValue({onLeave:"true"}),console.log(this.editAttendenceForm.value.onLeave)):this.editAttendenceForm.patchValue({onLeave:"false"}),this.productDialogForEdit=!0,this.getAttendances(this.eventa)}hideDialogForEdit(){console.log("obj"+this.attendenceObjectForEdit.startTime),console.log("form"+this.editAttendenceForm.value.endTime),this.productDialogForEdit=!1,this.submitted=!0,this.getAttendances(this.eventa)}saveAttendenceForEdit(n,t){this.attendenceService.updateAttendence(n,t).subscribe(i=>{console.log("in edit id",n),console.log("in edit attendence befor",t),t=i,console.log("in edit attendence after",t),this.productDialogForEdit=!1,this.getAttendances(this.eventa)},i=>console.log(i))}getAttendence(){this.totalRecords=0,console.log("coming.............."),this.attendenceService.getAttendenceListWithPagination(this.eventa).subscribe(n=>{this.paginator.changePage(0),this.attendences=n.content,this.totalRecords=n.totalElements})}onSelectMethod(n){let t=new Date(Date.parse(n));this.addAttendenceForm.value.dateCreated=`${t.getMonth()+1}/${t.getDate()}/${t.getFullYear()}`}getAttendances(n){this.totalRecords=0,this.attendences=[],this.eventa.page=n.page,this.eventa.rows=n.rows,console.log("in page check"),console.log("page",n.page),console.log("Row",n.rows),this.attendenceService.getAttendenceListWithPagination(this.eventa).subscribe(t=>{this.attendences=t.content,console.log(t),this.totalRecords=t.totalElements}),console.log("event data",n)}downloadCsv(){this.fileService.downloadAttendances(this.eventa).subscribe(n=>{const t=new Blob([n],{type:"text/csv"});O.saveAs(t,"Attendances.csv")})}}return o.\u0275fac=function(n){return new(n||o)(e.Y36(u.ez),e.Y36(L.d),e.Y36(q.b),e.Y36(M.I))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-testing"]],viewQuery:function(n,t){if(1&n&&e.Gf(N,7),2&n){let i;e.iGM(i=e.CRH())&&(t.paginator=i.first)}},decls:46,vars:30,consts:[[1,"grid"],[1,"col-12"],[1,"card","px-6","py-6"],["styleClass","mb-3"],[1,"row","p-fluid","p-formgrid","grid","field","col-12"],[1,"field","col-12","md:col-10"],[1,"mb-4","font-family:","Open","Sans,","sans-serif;"],[1,"field","col-12","md:col-2"],["pButton","","pRipple","","label","Export","icon","pi pi-upload",1,"p-button-help",3,"click"],[1,"row","red"],[1,"ml-4"],[1,"p-fluid","p-formgrid","grid"],[1,"field","col-12","md:col-2","ml-4"],["htmlFor","firstname2"],["inputId","dob","dateFormat","dd/mm/yy",1,"ng-invalid",3,"ngModel","showIcon","onSelect","ngModelChange"],["htmlFor","middlename"],["htmlFor","lastname"],["defaultLabel","Select a Branch","optionLabel","name","display","chip",3,"options","onChange","onDeselect"],["label","label","placeholder","Select","optionLabel","label",3,"options","ngModel","editable","onChange","ngModelChange"],[1,"field","col-12","md:col-1","mt-4"],["pButton","","pRipple","","pTooltip","Clear All Filters","icon","pi pi-filter-slash",1,"p-button-rounded","p-button-outline","mr-3",3,"click"],[1,"field","col-12","md:col-2","ml-8","mt-4"],[1,"mt-2","md:mt-0","p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search...",1,"w-full","sm:w-auto","mr-3",3,"input"],[1,"mt-3"],["scrollDirection","both","responsiveLayout","scroll","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries","selectionMode","multiple","dataKey","id",3,"value","rows","globalFilterFields","paginator","rowsPerPageOptions","showCurrentPageReport","totalRecords","selection","rowHover","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",3,"rows","showCurrentPageReport","totalRecords","rowsPerPageOptions","onPageChange"],["header","Attendence Details",1,"p-fluid",3,"visible","modal","visibleChange"],["pTemplate","content"],["pTemplate","footer"],["rowspan","3",2,"width","14%","min-width","10rem"],[1,"flex","justify-content-between","align-items-center"],["colspan","3",2,"width","14% min-width 10rem align-items-center"],[1,"flex","justify-content-between","align-items-center","ml-10"],["colspan","3",2,"width","14% min-width 10rem"],["rowspan","4",2,"width","14%","min-width","10rem"],["rowspan","5"],[2,"width","14%","min-width","10rem"],[4,"ngFor","ngForOf"],["width","100","height","100",3,"ngClass",4,"ngIf"],["width","100","height","100",3,"ngClass"],[2,"width","14%","min-width","8rem"],[1,"p-column-title"],["width","100","height","100",3,"hidden","src","preview"],["alt","Image","width","100","height","100",3,"hidden","src","preview"],[1,"flex"],["pButton","","pRipple","","pTooltip","Edit","icon","pi pi-pencil",1,"p-button-rounded","p-button-success","mr-2",3,"click"],[3,"formGroup"],["width","150",1,"mt-0","mx-auto","mb-5","block","shadow-2",3,"src"],[1,"field"],["for","onLeave"],["formControlName","onLeave","optionLabel","label","optionValue","value",3,"options"],["style","color:red",4,"ngIf"],[2,"color","red"],["pButton","","pRipple","","label","Cancel","icon","pi pi-times",1,"p-button-text",3,"click"],["pButton","","pRipple","","label","Save","icon","pi pi-check",1,"p-button-text",3,"click"]],template:function(n,t){1&n&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2),e._UZ(3,"p-toast"),e.TgZ(4,"p-toolbar",3)(5,"div",4)(6,"div",5)(7,"h4",6),e._uU(8,"Attendance Report"),e.qZA()(),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){return t.downloadCsv()}),e.qZA()()(),e.TgZ(11,"div",9)(12,"h5",10),e._uU(13,"Filters"),e.qZA(),e.TgZ(14,"div",11)(15,"div",12)(16,"label",13),e._uU(17,"From"),e.qZA(),e.TgZ(18,"p-calendar",14),e.NdJ("onSelect",function(l){return t.dateFromFilter(l)})("ngModelChange",function(l){return t.dateFromFilterVariable=l}),e.qZA()(),e.TgZ(19,"div",7)(20,"label",15),e._uU(21,"To"),e.qZA(),e.TgZ(22,"p-calendar",14),e.NdJ("onSelect",function(l){return t.dateToFilter(l)})("ngModelChange",function(l){return t.dateToFilterVariable=l}),e.qZA()(),e.TgZ(23,"div",7)(24,"label",16),e._uU(25,"Branch"),e.qZA(),e.TgZ(26,"p-multiSelect",17),e.NdJ("onChange",function(l){return t.branchFilter(l)})("onDeselect",function(l){return t.branchFilter(l)}),e.qZA()(),e.TgZ(27,"div",7)(28,"label",16),e._uU(29,"Leave"),e.qZA(),e.TgZ(30,"p-dropdown",18),e.NdJ("onChange",function(l){return t.leaveFilter(l)})("ngModelChange",function(l){return t.leaveFilterVariable=l}),e.qZA()(),e.TgZ(31,"div",19)(32,"button",20),e.NdJ("click",function(){return t.clearAllFilters()}),e.qZA()(),e.TgZ(33,"div",21)(34,"span",22),e._UZ(35,"i",23),e.TgZ(36,"input",24),e.NdJ("input",function(l){return t.forSearch(l)}),e.qZA()()()()()(),e.TgZ(37,"p-card",25)(38,"p-table",26,27),e.NdJ("selectionChange",function(l){return t.selectedAttendence=l}),e.YNc(40,I,36,0,"ng-template",28),e.YNc(41,J,1,1,"ng-template",29),e.qZA()(),e.TgZ(42,"p-paginator",30),e.NdJ("onPageChange",function(l){return t.getAttendances(l)}),e.qZA(),e.TgZ(43,"p-dialog",31),e.NdJ("visibleChange",function(l){return t.productDialogForEdit=l}),e.YNc(44,R,7,4,"ng-template",32),e.YNc(45,V,2,0,"ng-template",33),e.qZA()()()()),2&n&&(e.xp6(18),e.Q6J("ngModel",t.dateFromFilterVariable)("showIcon",!1),e.xp6(4),e.Q6J("ngModel",t.dateToFilterVariable)("showIcon",!1),e.xp6(4),e.Q6J("options",t.branchList),e.xp6(4),e.Q6J("options",t.leave)("ngModel",t.leaveFilterVariable)("editable",!1),e.xp6(8),e.Q6J("value",t.attendences)("rows",10)("globalFilterFields",e.DdM(26,k))("rows",10)("paginator",!1)("rowsPerPageOptions",e.DdM(27,Q))("showCurrentPageReport",!0)("totalRecords",t.totalRecords)("selection",t.selectedAttendence)("rowHover",!0),e.xp6(4),e.Q6J("rows",10)("showCurrentPageReport",!0)("totalRecords",t.totalRecords)("rowsPerPageOptions",e.DdM(28,B)),e.xp6(1),e.Akn(e.DdM(29,j)),e.Q6J("visible",t.productDialogForEdit)("modal",!0))},dependencies:[d.mk,d.sg,d.O5,s._Y,s.JJ,s.JL,s.On,s.sg,s.u,h.o,m.Hq,v.H,f.o,T.Z,u.jx,_.FN,Z.iA,A.f,b.V,F.D,S.Lt,C.UN,w.E,U.NU,y.u,d.uU],styles:["[_nghost-%COMP%]     .red{background-color:#f0f8ff}[_nghost-%COMP%]     .p-toolbar{display:contents!important}tr.OnLeave[_ngcontent-%COMP%]{color:red}tr.Present[_ngcontent-%COMP%]{color:#000}"]}),o})(),$=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[p.Bz.forChild([{path:"",component:Y}]),p.Bz]}),o})();var H=a(520);let G=(()=>{class o{}return o.\u0275fac=function(n){return new(n||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[d.ez,$,s.u5,s.UX,h.V,m.hJ,v.T,f.j,T.d,_.EV,Z.U$,A._8,H.JF,b.S,F.U,C.Qy,w.$,U.q4,y.z]}),o})()}}]);